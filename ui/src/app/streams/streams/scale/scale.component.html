<clr-modal [(clrModalOpen)]="isOpen" *ngIf="streamName" [clrModalClosable]="!isRunning">
  <h3 class="modal-title">
    Scale instance(s) for app
    <strong>{{ streamName }}</strong>
  </h3>
  <div class="modal-body">
    <div *ngIf="isLoading">
      <clr-spinner clrInline clrSmall></clr-spinner>&nbsp;
      <span>Fetching stream runtime statuses ...</span>
    </div>
    <form [formGroup]="form" *ngIf="!isLoading">
      <div>You can scale an application between 1 and 9 instances.</div>
      <table class="table table-striped">
        <thead>
          <tr>
            <th class="left">Name</th>
            <th class="left" style="width: 60px">Instances</th>
            <th class="left" style="width: 30px">&nbsp;</th>
          </tr>
        </thead>
        <tbody>
          <ng-container>
            <tr *ngFor="let instance of instances; index as i">
              <td class="left middle">
                {{ instance.name }}
              </td>
              <td class="left">
                <input
                  style="width: 50px"
                  type="number"
                  min="0"
                  max="9"
                  class="clr-input ng-pristine ng-valid ng-touched"
                  [formControlName]="'instance' + instance.name"
                />
              </td>
              <td nowrap="">
                <button
                  type="button"
                  class="btn btn-sm btn-secondary"
                  [disabled]="
                    form.get('instance' + instance.name)?.invalid || isValueNotChanged(instance) || instance.isScaling
                  "
                  (click)="scale(instance)"
                >
                  <clr-spinner *ngIf="instance.isScaling" clrInline clrSmall></clr-spinner>&nbsp;
                  <span *ngIf="!instance.isScaling">Scale</span>
                  <span *ngIf="instance.isScaling">Scaling</span>
                </button>
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline" (click)="isOpen = false">Close</button>
  </div>
</clr-modal>
